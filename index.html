<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Data Viewer with DataTables</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
        }
        #loading {
            text-align: center;
            font-size: 1.2em;
            color: #555;
        }
    </style>
</head>
<body>
    <h1>Data dari Google Sheets</h1>
    <div id="loading">Loading data...</div>
    <table id="data-table" class="display" style="width:100%; display: none;">
        <thead>
            <tr id="table-header"></tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        const googleSheetURL = "https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}/export?format=csv";

        // Ganti {SPREADSHEET_ID} dengan ID Google Sheets Anda
        const csvURL = googleSheetURL.replace("{SPREADSHEET_ID}", "1AoBL-QibTvkj0PIhFxx_IG0AEOSmQGkS");

        // Fetch and parse CSV data
        fetch(csvURL)
            .then(response => response.text())
            .then(csvData => {
                const parsedData = Papa.parse(csvData, { header: true });
                const rows = parsedData.data;

                // Get table elements
                const tableHeader = document.getElementById("table-header");
                const tableBody = document.querySelector("#data-table tbody");

                // Add table headers
                const headers = Object.keys(rows[0]);
                headers.forEach(header => {
                    const th = document.createElement("th");
                    th.textContent = header;
                    tableHeader.appendChild(th);
                });

                // Add table rows
                rows.forEach(row => {
                    const tr = document.createElement("tr");
                    headers.forEach(header => {
                        const td = document.createElement("td");
                        td.textContent = row[header];
                        tr.appendChild(td);
                    });
                    tableBody.appendChild(tr);
                });

                // Show table and initialize DataTables
                document.getElementById("loading").style.display = "none";
                const dataTable = document.getElementById("data-table");
                dataTable.style.display = "table";
                $(dataTable).DataTable();
            })
            .catch(error => {
                console.error("Error fetching or parsing data:", error);
                document.getElementById("loading").textContent = "Failed to load data.";
            });
    </script>
</body>
</html>
